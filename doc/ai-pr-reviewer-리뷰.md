# AI PR Reviewer êµ¬í˜„ ê²°ê³¼

## ê°œìš”

PR ìë™ ì½”ë“œ ë¦¬ë·° ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ. Gemini 2.5 Flashë¥¼ ì‚¬ìš©í•˜ì—¬ PR diffë¥¼ ë¶„ì„í•˜ê³  ë²„ê·¸, ë³´ì•ˆ ì·¨ì•½ì , ì„±ëŠ¥ ì´ìŠˆë¥¼ ìë™ìœ¼ë¡œ ê²€ì¶œí•©ë‹ˆë‹¤.

**êµ¬í˜„ ì¼ì**: 2026-01-27
**ê´€ë ¨ ì´ìŠˆ**: #191
**PR**: #193

---

## êµ¬í˜„ëœ ê¸°ëŠ¥

### 1. Meta-Review (ì˜¤íƒ í•„í„°ë§)

**ëª©ì **: AIê°€ ì°¾ì€ ì´ìŠˆ ì¤‘ ì˜¤íƒ(false positive)ì„ ì œê±°í•˜ê³  ì¤‘ìš”ë„ ìˆœ TOP 10ë§Œ ìœ ì§€

**ë™ì‘ ë°©ì‹**:
1. 1ì°¨ ë¦¬ë·°ì—ì„œ ëª¨ë“  ì´ìŠˆ ìˆ˜ì§‘
2. Geminië¡œ 2ì°¨ ê²€í†  (meta-review)
3. ì¤‘ë³µ ì œê±°, ìš°ì„ ìˆœìœ„ ì •ë ¬
4. TOP 10 ì´ìŠˆë§Œ ë°˜í™˜

**ê²°ê³¼**: 22ê°œ ì´ìŠˆ â†’ 10ê°œë¡œ í•„í„°ë§ (55% ê°ì†Œ)

```python
# CLI ì˜µì…˜
--no-meta-review  # Meta-review ë¹„í™œì„±í™”
```

### 2. DiffCompressor (í† í° ì ˆê°)

**ëª©ì **: Diffì˜ context ë¼ì¸ì„ ì••ì¶•í•˜ì—¬ API í† í° ì‚¬ìš©ëŸ‰ ê°ì†Œ

**ì••ì¶• ì „ëµ**:
- Context ë¼ì¸ 3ì¤„ â†’ 1ì¤„ë¡œ ì¶•ì†Œ
- ê³µë°±ë§Œ ë³€ê²½ëœ ë¼ì¸ ì œê±°
- Import ìˆœì„œ ë³€ê²½ ë¬´ì‹œ (ì¶”ê°€/ì‚­ì œëŠ” ìœ ì§€)

**ê²°ê³¼**: 41.4% í† í° ì ˆê° (ë³€ê²½ëœ íŒŒì¼ ê¸°ì¤€)

**ì£¼ì˜**: ì••ì¶• ì‹œ ì •í™•ë„ê°€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆì–´ **ê¸°ë³¸ ë¹„í™œì„±í™”**.

```python
# CLI ì˜µì…˜
--compress              # ì••ì¶• í™œì„±í™” (í† í° ì ˆê°, ì •í™•ë„ í•˜ë½ ê°€ëŠ¥)
--context-lines N       # Context ë¼ì¸ ìˆ˜ (ê¸°ë³¸ê°’: 3)
```

### 3. ì½”ë“œ í’ˆì§ˆ ê°œì„ 

| í•­ëª© | ë³€ê²½ ë‚´ìš© |
|------|----------|
| asyncio import | ë¯¸ì‚¬ìš© import ì œê±° |
| JSON ì¶”ì¶œ | `extract_json_from_response()` ê³µí†µ í•¨ìˆ˜ë¡œ 60ì¤„ ì¤‘ë³µ ì œê±° |
| Timeout | `API_TIMEOUT_SECONDS = 180` ìƒìˆ˜ë¡œ í†µì¼ |
| Windows ì¸ì½”ë”© | UTF-8 ëª…ì‹œë¡œ cp949 ì˜¤ë¥˜ í•´ê²° |

---

## GitHub Actions ì›Œí¬í”Œë¡œìš°

### íŒŒì¼ ìœ„ì¹˜
`.github/workflows/ai-code-review.yml`

### íŠ¸ë¦¬ê±° ì¡°ê±´
```yaml
on:
  pull_request:
    types: [opened, synchronize, reopened]
```

- `opened`: PR ìƒì„± ì‹œ
- `synchronize`: PRì— ìƒˆ ì»¤ë°‹ í‘¸ì‹œ ì‹œ
- `reopened`: ë‹«íŒ PR ì¬ì˜¤í”ˆ ì‹œ

### ë™ì‹œ ì‹¤í–‰ ë°©ì§€
```yaml
concurrency:
  group: ai-review-${{ github.event.pull_request.number }}
  cancel-in-progress: true
```

ê°™ì€ PRì˜ ì´ì „ ë¦¬ë·°ê°€ ì§„í–‰ ì¤‘ì´ë©´ ì·¨ì†Œí•˜ê³  ìƒˆ ë¦¬ë·° ì‹œì‘.

### Job êµ¬ì¡°

```
check-files â†’ ai-code-review
```

1. **check-files**: ì½”ë“œ íŒŒì¼ ë³€ê²½ ì—¬ë¶€ í™•ì¸
   - `.kt`, `.java`, `.py`, `.ts`, `.tsx`, `.js`, `.jsx`, `.swift` íŒ¨í„´ ë§¤ì¹­
   - ì„¤ì •/ë¬¸ì„œë§Œ ë³€ê²½ ì‹œ ë¦¬ë·° ìŠ¤í‚µ

2. **ai-code-review**: AI ë¦¬ë·° ì‹¤í–‰
   - Draft PR ìŠ¤í‚µ
   - 200KB ì´ìƒ diff ìŠ¤í‚µ
   - ê²°ê³¼ë¥¼ PR ì½”ë©˜íŠ¸ë¡œ ê²Œì‹œ

### í•„ìˆ˜ Secrets

| Secret | ì„¤ëª… |
|--------|------|
| `GEMINI_API_KEY` | Google Gemini API í‚¤ |

ì„¤ì • ê²½ë¡œ: Repository Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret

---

## AI ë¦¬ë·° ì •í™•ë„ ë¶„ì„

### PR #193 ë¦¬ë·° ê²°ê³¼

| ì´ìŠˆ | ìœ íš¨ì„± | ë¹„ê³  |
|------|--------|------|
| exit code ë³€ê²½ | False Positive | ì˜ë„ì  ë³€ê²½ì´ë‚˜ AIê°€ ë²„ê·¸ë¡œ íŒë‹¨ |
| large diff ì¸ì½”ë”© | Valid | ì‹¤ì œ ê°œì„  í•„ìš” |
| stats íŒŒë¼ë¯¸í„° ê²€ì¦ | Valid | íƒ€ì… ì²´í¬ ê°œì„  ê°€ëŠ¥ |
| API rate limit ì²˜ë¦¬ | Valid | ì¬ì‹œë„ ë¡œì§ ê¶Œì¥ |
| ìœ ë‹ˆì½”ë“œ ì¸ì½”ë”© | Valid | ì´ë¯¸ ìˆ˜ì •ë¨ |

**ì •í™•ë„**: ì•½ 60% (5ê°œ ì¤‘ 3ê°œ ìœ íš¨, 1ê°œ ì˜¤íƒ)

### ì˜¤íƒ íŒ¨í„´

1. **ì˜ë„ì  ë³€ê²½ ê°ì§€ ì‹¤íŒ¨**: ë²„ê·¸ ìˆ˜ì •ì„ ìœ„í•œ ì˜ë„ì  ì½”ë“œ ë³€ê²½ì„ ë²„ê·¸ë¡œ ì˜¤ì¸
2. **ì»¨í…ìŠ¤íŠ¸ ë¶€ì¡±**: PR ì „ì²´ ë§¥ë½ ì—†ì´ diffë§Œ ë³´ê³  íŒë‹¨

---

## ì œí•œì‚¬í•­

### Rate Limiting
- Gemini ë¬´ë£Œ í‹°ì–´: 20 req/min
- Meta-review ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì´ìŠˆ ë°˜í™˜ (graceful degradation)

### ëŒ€ìš©ëŸ‰ PR
- 500KB ì´ìƒ diff: ì²­í‚¹(chunking)ìœ¼ë¡œ íŒŒì¼ë³„ ë¶„ë¦¬ ë¦¬ë·°
- 100KB~500KB: ê²½ê³  í‘œì‹œ í›„ ì²­í‚¹ ì§„í–‰
- **ìŠ¤í‚µ ì—†ìŒ**: ëª¨ë“  PR ë¦¬ë·° ê°€ëŠ¥

### ì§€ì› ì–¸ì–´
- Kotlin, Java, Python, TypeScript, JavaScript, Swift
- ê¸°íƒ€ í™•ì¥ìëŠ” ë¦¬ë·° ëŒ€ìƒì—ì„œ ì œì™¸

---

## ë¡œì»¬ í…ŒìŠ¤íŠ¸

```bash
# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
$env:GEMINI_API_KEY = "your-api-key"

# PR diffë¡œ í…ŒìŠ¤íŠ¸
gh pr diff 193 > test_diff.txt
python script/ai_pr_reviewer.py --diff-file test_diff.txt --gemini-only

# ì˜µì…˜ ì¡°í•©
python script/ai_pr_reviewer.py \
  --diff-file test_diff.txt \
  --output review.md \
  --json review.json \
  --gemini-only \
  --no-compress \
  --no-meta-review
```

---

## ì„±ëŠ¥ ê°œì„  ë° ì„¤ì • ë³€ê²½ (2026-01-27)

### ì •í™•ë„ ìš°ì„  ì„¤ì •

| í•­ëª© | ë³€ê²½ ì „ | ë³€ê²½ í›„ | ì´ìœ  |
|------|---------|---------|------|
| Diff ì••ì¶• | ê¸°ë³¸ ON | **ê¸°ë³¸ OFF** | Context ì¶•ì†Œ ì‹œ AI ë§¥ë½ ì´í•´ ì €í•˜ |
| Context ë¼ì¸ | 1ì¤„ | **3ì¤„** | ì½”ë“œ ë§¥ë½ ë³´ì¡´ìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ |
| ëŒ€ìš©ëŸ‰ diff | 200KB ìŠ¤í‚µ | **500KB ì²­í‚¹** | ëª¨ë“  PR ë¦¬ë·° ê°€ëŠ¥ |

```bash
# í† í° ì ˆê° ëª¨ë“œ (ì •í™•ë„ í•˜ë½ ê°€ëŠ¥)
--compress --context-lines 1

# ì •í™•ë„ ìš°ì„  ëª¨ë“œ (ê¸°ë³¸)
# ì˜µì…˜ ì—†ì´ ì‹¤í–‰
```

### AI ë¦¬ë·°ì–´ ì„ íƒ

| ëª¨ë¸ | ìƒíƒœ | ì´ìœ  |
|------|------|------|
| **Gemini 2.5 Flash** | âœ… ì‚¬ìš© | ì•ˆì •ì , ì ì ˆí•œ ì •í™•ë„ |
| GLM-4-Flash | âŒ ë¹„í™œì„±í™” | ì˜¤íƒ ë§ìŒ (Shebang ë³´ì•ˆ ìœ„í˜‘ ë“± ë¶€ì ì ˆí•œ ì´ìŠˆ) |

```yaml
# ì›Œí¬í”Œë¡œìš° ì„¤ì •
python script/ai_pr_reviewer.py --gemini-only
```

### Merge ì°¨ë‹¨ ì •ì±…

| ì´ìŠˆ ì‹¬ê°ë„ | ë™ì‘ | ì„¤ëª… |
|-------------|------|------|
| ğŸ”´ **Critical** | **Merge ì°¨ë‹¨** | ì›Œí¬í”Œë¡œìš° ì‹¤íŒ¨ (exit 1) |
| ğŸŸ  High | ê²½ê³  í‘œì‹œ | Merge ê°€ëŠ¥ |
| ğŸŸ¡ Medium | í‘œì‹œë§Œ | Merge ê°€ëŠ¥ |
| ğŸŸ¢ Low | í‘œì‹œë§Œ | Merge ê°€ëŠ¥ |

**Branch Protection ì„¤ì • í•„ìš”**:
- Settings â†’ Branches â†’ Add rule
- "Require status checks" í™œì„±í™”
- "AI Code Review" ì²´í¬

### Rate Limiting ì—…ë°ì´íŠ¸

| í‹°ì–´ | ì œí•œ | ë¹„ê³  |
|------|------|------|
| Gemini ë¬´ë£Œ | **20 req/day** (ëª¨ë¸ë‹¹) | ì¼ì¼ í• ë‹¹ëŸ‰ |
| Gemini ìœ ë£Œ | 1000+ req/min | ê¶Œì¥ |

**Rate Limit ì´ˆê³¼ ì‹œ**:
- Meta-review ìŠ¤í‚µ â†’ ì›ë³¸ ì´ìŠˆ ë°˜í™˜
- ë‹¤ìŒ ë‚  ìë™ ë¦¬ì…‹

---

## í–¥í›„ ê°œì„ ì‚¬í•­

1. **ì»¨í…ìŠ¤íŠ¸ í™•ì¥**: PR description, ê´€ë ¨ ì´ìŠˆ ë‚´ìš© í¬í•¨
2. **í•™ìŠµ í”¼ë“œë°±**: ì˜¤íƒ ë§ˆí‚¹ìœ¼ë¡œ ì •í™•ë„ ê°œì„ 
3. **ë‹¤ì¤‘ ëª¨ë¸**: GLM-4 ë³‘ë ¬ ì‹¤í–‰ìœ¼ë¡œ êµì°¨ ê²€ì¦
4. **ì¸ë¼ì¸ ì½”ë©˜íŠ¸**: íŒŒì¼ë³„ ë¼ì¸ ì½”ë©˜íŠ¸ ì§€ì›

---

## ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `script/ai_pr_reviewer.py` | AI ë¦¬ë·°ì–´ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ |
| `.github/workflows/ai-code-review.yml` | GitHub Actions ì›Œí¬í”Œë¡œìš° |
| `.claude/agents/ai-pr-reviewer.md` | Claude Code ì—ì´ì „íŠ¸ ì„¤ì • |
| `.claude/plans/reflective-percolating-popcorn.md` | êµ¬í˜„ ê³„íšì„œ |
