spring:
  application:
    name: fanpulse-backend-test

  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL
    username: sa
    password:
    driver-class-name: org.h2.Driver

  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        format_sql: true

  flyway:
    enabled: false  # Disable Flyway for H2-based tests (use integration-test profile for Flyway tests)

fanpulse:
  jwt:
    secret: test-secret-key-min-256-bits-for-hs256-algorithm-requirements-met-here-for-testing
    access-expiration: 3600000      # 1 hour
    refresh-expiration: 604800000   # 7 days

  google:
    client-id: test-google-client-id.apps.googleusercontent.com

  youtube:
    oembed:
      base-url: http://localhost:8089/oembed
      timeout-ms: 3000
      retry:
        max-attempts: 2
        delay-ms: 500

  discovery:
    ytdlp:
      command: yt-dlp
      timeout-ms: 2000
      playlist-limit: 5
      extract-flat: false

  scheduler:
    metadata-refresh:
      enabled: false
      live-cron: "0 0 * * * *"
      all-cron: "0 0 0 * * *"
      batch-size: 10
      batch-delay-ms: 100
    live-discovery:
      enabled: false
      cron: "0 0 * * * *"
      channel-delay-ms: 0

# Resilience4j - disabled for tests
resilience4j:
  circuitbreaker:
    instances:
      youtubeOEmbed:
        registerHealthIndicator: false
        slidingWindowSize: 100
        minimumNumberOfCalls: 100
        failureRateThreshold: 100
        waitDurationInOpenState: 1s

logging:
  level:
    com.fanpulse: DEBUG
