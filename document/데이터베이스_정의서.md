# ğŸ’½ FanPulse ë°ì´í„°ë² ì´ìŠ¤ ì •ì˜ì„œ

## 1. ê°œìš”

ë³¸ ë¬¸ì„œëŠ” **FanPulse** ì„œë¹„ìŠ¤ì˜ ë°ì´í„° ëª¨ë¸ì„ ì •ì˜í•˜ë©°, ê¸°ì¡´ ë°ì´í„° ëª¨ë¸ê³¼ í¬ë¡¤ë§ ë°ì´í„° ëª¨ë¸ì„ í¬í•¨í•©ë‹ˆë‹¤.

---

## 2. ì£¼ìš” í…Œì´ë¸” ë° ê´€ê³„

-   **users**: ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬ (ë¡œê·¸ì¸, íšŒì›ê°€ì…)
-   **auth_tokens**: ì‚¬ìš©ì ì¸ì¦ í† í° ì €ì¥
-   **polls, vote_options, votes**: íˆ¬í‘œ ì‹œìŠ¤í…œ êµ¬í˜„ (polls â†’ vote_options â†’ votes ìˆœì„œ)
-   **notifications**: ì‚¬ìš©ì ì•Œë¦¼ ê¸°ëŠ¥
-   **media**: ì´ë¯¸ì§€ ë° ë™ì˜ìƒ ì €ì¥
-   **points, point_transactions**: í¬ì¸íŠ¸ ì ë¦½ ë° ì‚¬ìš© ê¸°ë¡
-   **memberships**: VIP ë©¤ë²„ì‹­ ê´€ë¦¬
-   **likes**: ê²Œì‹œê¸€/ëŒ“ê¸€ ì¢‹ì•„ìš” ê¸°ëŠ¥
-   **streaming_events**: ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸
-   **crawled_news, crawled_charts, crawled_concerts**: í¬ë¡¤ë§ëœ ë°ì´í„°

> **ì£¼ì˜**: postsì™€ commentsëŠ” MongoDB ì»¬ë ‰ì…˜ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤. (4ë²ˆ ì„¹ì…˜ ì°¸ê³ )

## 2.1 ë°ì´í„° ëª¨ë¸

### ì‚¬ìš©ì í…Œì´ë¸” (users)

| ì»¬ëŸ¼ëª…        | ë°ì´í„° íƒ€ì…             | ì„¤ëª…               |
| ------------- | ----------------------- | ------------------ |
| id (PK)       | UUID                    | ì‚¬ìš©ì ê³ ìœ  ì‹ë³„ì |
| username      | VARCHAR(50) UNIQUE      | ì‚¬ìš©ìëª…           |
| email         | VARCHAR(100) UNIQUE     | ì´ë©”ì¼ ì£¼ì†Œ        |
| password_hash | TEXT                    | ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ      |
| created_at    | TIMESTAMP DEFAULT NOW() | ê°€ì… ì¼ì‹œ          |

### ì¸ì¦ í† í° í…Œì´ë¸” (auth_tokens)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì… | ì„¤ëª…                  |
| ------------ | ----------- | --------------------- |
| id (PK)      | UUID        | ì¸ì¦ í† í° ê³ ìœ  ì‹ë³„ì |
| user_id (FK) | UUID        | ì‚¬ìš©ì ID             |
| token        | TEXT UNIQUE | ì¸ì¦ í† í°             |
| expires_at   | TIMESTAMP   | ë§Œë£Œ ì‹œê°„             |

### íˆ¬í‘œ í…Œì´ë¸” (votes)

| ì»¬ëŸ¼ëª…              | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                |
| ------------------- | ----------------------- | ------------------- |
| id (PK)             | UUID                    | íˆ¬í‘œ ê³ ìœ  ì‹ë³„ì    |
| user_id (FK)        | UUID                    | ì‚¬ìš©ì ID           |
| vote_option_id (FK) | UUID                    | ì„ íƒí•œ íˆ¬í‘œ ì˜µì…˜ ID |
| poll_id (FK)        | UUID                    | ê´€ë ¨ëœ íˆ¬í‘œ ID      |
| created_at          | TIMESTAMP DEFAULT NOW() | íˆ¬í‘œ ì¼ì‹œ           |

### íˆ¬í‘œ ì˜µì…˜ í…Œì´ë¸” (vote_options)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì… | ì„¤ëª…             |
| ------------ | ----------- | ---------------- |
| id (PK)      | UUID        | ì˜µì…˜ ê³ ìœ  ì‹ë³„ì |
| poll_id (FK) | UUID        | ê´€ë ¨ëœ íˆ¬í‘œ ID   |
| option_text  | TEXT        | ì˜µì…˜ ë‚´ìš©        |

### íˆ¬í‘œ ì§„í–‰ í…Œì´ë¸” (polls)

| ì»¬ëŸ¼ëª…      | ë°ì´í„° íƒ€ì…             | ì„¤ëª…             |
| ----------- | ----------------------- | ---------------- |
| id (PK)     | UUID                    | íˆ¬í‘œ ê³ ìœ  ì‹ë³„ì |
| title       | VARCHAR(100)            | íˆ¬í‘œ ì œëª©        |
| description | TEXT                    | ì„¤ëª…             |
| created_at  | TIMESTAMP DEFAULT NOW() | ìƒì„± ì¼ì‹œ        |
| expires_at  | TIMESTAMP               | ë§Œë£Œ ì¼ì‹œ        |

### ì•Œë¦¼ í…Œì´ë¸” (notifications)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…             |
| ------------ | ----------------------- | ---------------- |
| id (PK)      | UUID                    | ì•Œë¦¼ ê³ ìœ  ì‹ë³„ì |
| user_id (FK) | UUID                    | ì‚¬ìš©ì ID        |
| message      | TEXT                    | ì•Œë¦¼ ë‚´ìš©        |
| is_read      | BOOLEAN DEFAULT FALSE   | ì½ìŒ ì—¬ë¶€        |
| created_at   | TIMESTAMP DEFAULT NOW() | ìƒì„± ì¼ì‹œ        |

### ë¯¸ë””ì–´ í…Œì´ë¸” (media)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                            |
| ------------ | ----------------------- | ------------------------------- |
| id (PK)      | UUID                    | ë¯¸ë””ì–´ ê³ ìœ  ì‹ë³„ì              |
| user_id (FK) | UUID                    | ì—…ë¡œë” ID                       |
| media_url    | TEXT                    | ë¯¸ë””ì–´ URL                      |
| media_type   | VARCHAR(50)             | ë¯¸ë””ì–´ íƒ€ì… (ì´ë¯¸ì§€, ë™ì˜ìƒ ë“±) |
| uploaded_at  | TIMESTAMP DEFAULT NOW() | ì—…ë¡œë“œ ì¼ì‹œ                     |

### í¬ì¸íŠ¸ í…Œì´ë¸” (points)

| ì»¬ëŸ¼ëª…        | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                    |
| ------------- | ----------------------- | ----------------------- |
| id (PK)       | UUID                    | í¬ì¸íŠ¸ ê¸°ë¡ ê³ ìœ  ì‹ë³„ì |
| user_id (FK)  | UUID                    | ì‚¬ìš©ì ID               |
| amount        | INT DEFAULT 0           | í˜„ì¬ í¬ì¸íŠ¸ ì”ì•¡        |
| earned_points | INT DEFAULT 0           | ëˆ„ì  íšë“ í¬ì¸íŠ¸        |
| spent_points  | INT DEFAULT 0           | ëˆ„ì  ì‚¬ìš© í¬ì¸íŠ¸        |
| updated_at    | TIMESTAMP DEFAULT NOW() | ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì¼ì‹œ    |

### í¬ì¸íŠ¸ ê¸°ë¡ í…Œì´ë¸” (point_transactions)

| ì»¬ëŸ¼ëª…           | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                                |
| ---------------- | ----------------------- | ----------------------------------- |
| id (PK)          | UUID                    | ê±°ë˜ ê³ ìœ  ì‹ë³„ì                    |
| user_id (FK)     | UUID                    | ì‚¬ìš©ì ID                           |
| transaction_type | VARCHAR(20)             | ê±°ë˜ ìœ í˜• (EARN, SPEND)             |
| amount           | INT                     | í¬ì¸íŠ¸ ì–‘                           |
| source           | VARCHAR(50)             | í¬ì¸íŠ¸ ì¶œì²˜ (ê´‘ê³ ì‹œì²­, êµ¿ì¦ˆêµ¬ë§¤ ë“±) |
| description      | TEXT                    | ê±°ë˜ ì„¤ëª…                           |
| created_at       | TIMESTAMP DEFAULT NOW() | ê±°ë˜ ì¼ì‹œ                           |

### ë©¤ë²„ì‹­ í…Œì´ë¸” (memberships)

| ì»¬ëŸ¼ëª…          | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                    |
| --------------- | ----------------------- | ----------------------- |
| id (PK)         | UUID                    | ë©¤ë²„ì‹­ ê³ ìœ  ì‹ë³„ì      |
| user_id (FK)    | UUID                    | ì‚¬ìš©ì ID               |
| membership_type | VARCHAR(20)             | ë©¤ë²„ì‹­ ìœ í˜• (FREE, VIP) |
| start_date      | TIMESTAMP               | ì‹œì‘ì¼                  |
| end_date        | TIMESTAMP               | ë§Œë£Œì¼                  |
| is_active       | BOOLEAN DEFAULT TRUE    | í™œì„± ì—¬ë¶€               |
| created_at      | TIMESTAMP DEFAULT NOW() | ê°€ì…ì¼                  |

### ì¢‹ì•„ìš” í…Œì´ë¸” (likes)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                              |
| ------------ | ----------------------- | --------------------------------- |
| id (PK)      | UUID                    | ì¢‹ì•„ìš” ê³ ìœ  ì‹ë³„ì                |
| user_id (FK) | UUID                    | ì‚¬ìš©ì ID                         |
| target_type  | VARCHAR(20)             | ëŒ€ìƒ íƒ€ì… (POST, COMMENT)         |
| target_id    | UUID                    | ëŒ€ìƒ ID (post_id ë˜ëŠ” comment_id) |
| created_at   | TIMESTAMP DEFAULT NOW() | ì¢‹ì•„ìš” ëˆ„ë¥¸ ì¼ì‹œ                  |

### ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ í…Œì´ë¸” (streaming_events)

| ì»¬ëŸ¼ëª…        | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                          |
| ------------- | ----------------------- | ----------------------------- |
| id (PK)       | UUID                    | ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ ê³ ìœ  ì‹ë³„ì   |
| title         | VARCHAR(255)            | ìŠ¤íŠ¸ë¦¬ë° ì œëª©                 |
| description   | TEXT                    | ì„¤ëª…                          |
| stream_url    | TEXT                    | ìŠ¤íŠ¸ë¦¬ë° URL                  |
| thumbnail_url | TEXT                    | ì¸ë„¤ì¼ ì´ë¯¸ì§€ URL             |
| artist_id     | UUID                    | ì•„í‹°ìŠ¤íŠ¸ ID                   |
| scheduled_at  | TIMESTAMP               | ì˜ˆì • ì‹œê°„                     |
| started_at    | TIMESTAMP               | ì‹¤ì œ ì‹œì‘ ì‹œê°„                |
| ended_at      | TIMESTAMP               | ì¢…ë£Œ ì‹œê°„                     |
| status        | VARCHAR(20)             | ìƒíƒœ (SCHEDULED, LIVE, ENDED) |
| viewer_count  | INT DEFAULT 0           | ì‹¤ì‹œê°„ ì‹œì²­ì ìˆ˜              |
| created_at    | TIMESTAMP DEFAULT NOW() | ìƒì„±ì¼                        |

### í¬ë¡¤ë§ëœ ë‰´ìŠ¤ ë°ì´í„° í…Œì´ë¸” (crawled_news)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                               |
| ------------ | ----------------------- | ---------------------------------- |
| id (PK)      | UUID                    | ë‰´ìŠ¤ ê³ ìœ  ì‹ë³„ì                   |
| title        | VARCHAR(255)            | ë‰´ìŠ¤ ì œëª©                          |
| content      | TEXT                    | ë‰´ìŠ¤ ë³¸ë¬¸ ìš”ì•½                     |
| url          | VARCHAR(500)            | ë‰´ìŠ¤ ì›ë³¸ ë§í¬                     |
| source       | VARCHAR(100)            | ë‰´ìŠ¤ ì¶œì²˜ (ì˜ˆ: Naver, Google News) |
| published_at | TIMESTAMP               | ë‰´ìŠ¤ ê²Œì‹œ ë‚ ì§œ                     |
| created_at   | TIMESTAMP DEFAULT NOW() | ì €ì¥ëœ ì‹œê°„                        |

### í¬ë¡¤ë§ëœ ì°¨íŠ¸ ìˆœìœ„ ë°ì´í„° í…Œì´ë¸” (crawled_charts)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…  | ì„¤ëª…                             |
| ------------ | ------------ | -------------------------------- |
| id (PK)      | UUID         | ìˆœìœ„ ê³ ìœ  ì‹ë³„ì                 |
| rank         | INT          | ì°¨íŠ¸ ìˆœìœ„                        |
| artist       | VARCHAR(255) | ì•„í‹°ìŠ¤íŠ¸ ì´ë¦„                    |
| song         | VARCHAR(255) | ê³¡ ì œëª©                          |
| chart_source | VARCHAR(100) | ì°¨íŠ¸ ì¶œì²˜ (ì˜ˆ: Billboard, Melon) |
| updated_at   | TIMESTAMP    | ìµœì‹  ì—…ë°ì´íŠ¸                    |

### í¬ë¡¤ë§ëœ ì½˜ì„œíŠ¸ ì¼ì • ë°ì´í„° í…Œì´ë¸” (crawled_concerts)

| ì»¬ëŸ¼ëª…      | ë°ì´í„° íƒ€ì…             | ì„¤ëª…             |
| ----------- | ----------------------- | ---------------- |
| id (PK)     | UUID                    | ê³µì—° ê³ ìœ  ì‹ë³„ì |
| event_name  | VARCHAR(255)            | ê³µì—°ëª…           |
| artist      | VARCHAR(255)            | ê³µì—° ì•„í‹°ìŠ¤íŠ¸    |
| venue       | VARCHAR(255)            | ê³µì—° ì¥ì†Œ        |
| date        | TIMESTAMP               | ê³µì—° ë‚ ì§œ        |
| ticket_link | VARCHAR(500)            | í‹°ì¼“ ì˜ˆë§¤ ë§í¬   |
| created_at  | TIMESTAMP DEFAULT NOW() | ì €ì¥ëœ ì‹œê°„      |

### ì•„í‹°ìŠ¤íŠ¸ í…Œì´ë¸” (artists)

> **í™œìš© í™”ë©´**: H014 (ì•„í‹°ìŠ¤íŠ¸ ìƒì„¸ í˜ì´ì§€), H003 (íŒ¬ ì»¤ë®¤ë‹ˆí‹°)

| ì»¬ëŸ¼ëª…            | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                 |
| ----------------- | ----------------------- | -------------------- |
| id (PK)           | UUID                    | ì•„í‹°ìŠ¤íŠ¸ ê³ ìœ  ì‹ë³„ì |
| name              | VARCHAR(100)            | ì•„í‹°ìŠ¤íŠ¸/ê·¸ë£¹ëª…      |
| debut_date        | DATE                    | ë°ë·” ë‚ ì§œ            |
| agency            | VARCHAR(100)            | ì†Œì†ì‚¬               |
| genre             | VARCHAR(50)             | ì¥ë¥´                 |
| fandom_name       | VARCHAR(50)             | íŒ¬ë¤ ëª…ì¹­            |
| profile_image_url | TEXT                    | í”„ë¡œí•„ ì´ë¯¸ì§€ URL    |
| description       | TEXT                    | ì†Œê°œê¸€               |
| created_at        | TIMESTAMP DEFAULT NOW() | ìƒì„±ì¼               |

### ì‚¬ìš©ì íŒ”ë¡œìš° í…Œì´ë¸” (user_favorites)

> **í™œìš© í™”ë©´**: H020 (ì¢‹ì•„ìš”í•œ ì•„í‹°ìŠ¤íŠ¸)

| ì»¬ëŸ¼ëª…         | ë°ì´í„° íƒ€ì…             | ì„¤ëª…               |
| -------------- | ----------------------- | ------------------ |
| id (PK)        | UUID                    | íŒ”ë¡œìš° ê³ ìœ  ì‹ë³„ì |
| user_id (FK)   | UUID                    | ì‚¬ìš©ì ID          |
| artist_id (FK) | UUID                    | ì•„í‹°ìŠ¤íŠ¸ ID        |
| created_at     | TIMESTAMP DEFAULT NOW() | íŒ”ë¡œìš° ì¼ì‹œ        |

### ì €ì¥í•œ ê²Œì‹œë¬¼ í…Œì´ë¸” (saved_posts)

> **í™œìš© í™”ë©´**: H021 (ì €ì¥í•œ ê²Œì‹œë¬¼)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                         |
| ------------ | ----------------------- | ---------------------------- |
| id (PK)      | UUID                    | ì €ì¥ ê³ ìœ  ì‹ë³„ì             |
| user_id (FK) | UUID                    | ì‚¬ìš©ì ID                    |
| post_id      | VARCHAR(24)             | ê²Œì‹œê¸€ ID (MongoDB ObjectId) |
| created_at   | TIMESTAMP DEFAULT NOW() | ì €ì¥ ì¼ì‹œ                    |

### ì˜ˆë§¤ ë‚´ì—­ í…Œì´ë¸” (ticket_reservations)

> **í™œìš© í™”ë©´**: H022 (ì˜ˆë§¤ ë‚´ì—­)

| ì»¬ëŸ¼ëª…          | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                                      |
| --------------- | ----------------------- | ----------------------------------------- |
| id (PK)         | UUID                    | ì˜ˆë§¤ ê³ ìœ  ì‹ë³„ì                          |
| user_id (FK)    | UUID                    | ì‚¬ìš©ì ID                                 |
| concert_id (FK) | UUID                    | ì½˜ì„œíŠ¸ ID (crawled_concerts)              |
| status          | VARCHAR(20)             | ì˜ˆë§¤ ìƒíƒœ (RESERVED, CANCELLED, REFUNDED) |
| ticket_count    | INT                     | ì˜ˆë§¤ í‹°ì¼“ ìˆ˜                              |
| total_price     | DECIMAL(10,2)           | ì´ ê²°ì œ ê¸ˆì•¡                              |
| qr_code         | TEXT                    | í‹°ì¼“ QR ì½”ë“œ                              |
| reserved_at     | TIMESTAMP DEFAULT NOW() | ì˜ˆë§¤ ì¼ì‹œ                                 |
| updated_at      | TIMESTAMP               | ìƒíƒœ ë³€ê²½ ì¼ì‹œ                            |

### ê³ ê°ì„¼í„° ë¬¸ì˜ í…Œì´ë¸” (support_tickets)

> **í™œìš© í™”ë©´**: H023 (ê³ ê°ì„¼í„°)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                                       |
| ------------ | ----------------------- | ------------------------------------------ |
| id (PK)      | UUID                    | ë¬¸ì˜ ê³ ìœ  ì‹ë³„ì                           |
| user_id (FK) | UUID                    | ì‚¬ìš©ì ID                                  |
| title        | VARCHAR(200)            | ë¬¸ì˜ ì œëª©                                  |
| content      | TEXT                    | ë¬¸ì˜ ë‚´ìš©                                  |
| status       | VARCHAR(20)             | ì²˜ë¦¬ ìƒíƒœ (PENDING, IN_PROGRESS, RESOLVED) |
| created_at   | TIMESTAMP DEFAULT NOW() | ë¬¸ì˜ ì¼ì‹œ                                  |
| resolved_at  | TIMESTAMP               | ì²˜ë¦¬ ì™„ë£Œ ì¼ì‹œ                             |

### FAQ í…Œì´ë¸” (faq)

> **í™œìš© í™”ë©´**: H023 (ê³ ê°ì„¼í„°)

| ì»¬ëŸ¼ëª…        | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                             |
| ------------- | ----------------------- | -------------------------------- |
| id (PK)       | UUID                    | FAQ ê³ ìœ  ì‹ë³„ì                  |
| question      | VARCHAR(500)            | ì§ˆë¬¸                             |
| answer        | TEXT                    | ë‹µë³€                             |
| category      | VARCHAR(50)             | ì¹´í…Œê³ ë¦¬ (ê³„ì •, ê²°ì œ, ì„œë¹„ìŠ¤ ë“±) |
| display_order | INT                     | ë…¸ì¶œ ìˆœì„œ                        |
| is_active     | BOOLEAN DEFAULT TRUE    | í™œì„± ì—¬ë¶€                        |
| created_at    | TIMESTAMP DEFAULT NOW() | ìƒì„±ì¼                           |

### ê²€ìƒ‰ ê¸°ë¡ í…Œì´ë¸” (search_history)

> **í™œìš© í™”ë©´**: H018 (ê²€ìƒ‰ í™”ë©´)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                  |
| ------------ | ----------------------- | --------------------- |
| id (PK)      | UUID                    | ê²€ìƒ‰ ê¸°ë¡ ê³ ìœ  ì‹ë³„ì |
| user_id (FK) | UUID                    | ì‚¬ìš©ì ID             |
| keyword      | VARCHAR(100)            | ê²€ìƒ‰ í‚¤ì›Œë“œ           |
| created_at   | TIMESTAMP DEFAULT NOW() | ê²€ìƒ‰ ì¼ì‹œ             |

### í¬ë¡¤ë§ëœ ê´‘ê³  ìƒí’ˆ í…Œì´ë¸” (crawled_ads)

> **í™œìš© í™”ë©´**: H008 (ê´‘ê³  & ë¦¬ì›Œë“œ)

| ì»¬ëŸ¼ëª…       | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                            |
| ------------ | ----------------------- | ------------------------------- |
| id (PK)      | UUID                    | ê´‘ê³  ìƒí’ˆ ê³ ìœ  ì‹ë³„ì           |
| product_name | VARCHAR(200)            | ìƒí’ˆëª…                          |
| description  | TEXT                    | ìƒí’ˆ ì„¤ëª…                       |
| price        | DECIMAL(10,2)           | ê°€ê²©                            |
| image_url    | TEXT                    | ìƒí’ˆ ì´ë¯¸ì§€ URL                 |
| source       | VARCHAR(50)             | ì¶œì²˜ (Ktown4u, Weverse Shop ë“±) |
| product_url  | TEXT                    | ìƒí’ˆ ë§í¬                       |
| is_event     | BOOLEAN DEFAULT FALSE   | ì´ë²¤íŠ¸ ìƒí’ˆ ì—¬ë¶€                |
| crawled_at   | TIMESTAMP DEFAULT NOW() | í¬ë¡¤ë§ ì¼ì‹œ                     |

### í¬ì¸íŠ¸ êµí™˜ ìƒí’ˆ í…Œì´ë¸” (rewards)

> **í™œìš© í™”ë©´**: H008 (ê´‘ê³  & ë¦¬ì›Œë“œ)

| ì»¬ëŸ¼ëª…          | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                               |
| --------------- | ----------------------- | ---------------------------------- |
| id (PK)         | UUID                    | ìƒí’ˆ ê³ ìœ  ì‹ë³„ì                   |
| name            | VARCHAR(200)            | ìƒí’ˆëª…                             |
| description     | TEXT                    | ìƒí’ˆ ì„¤ëª…                          |
| required_points | INT                     | í•„ìš” í¬ì¸íŠ¸                        |
| image_url       | TEXT                    | ìƒí’ˆ ì´ë¯¸ì§€ URL                    |
| category        | VARCHAR(50)             | ì¹´í…Œê³ ë¦¬ (êµ¿ì¦ˆ, ë©¤ë²„ì‹­, í• ì¸ê¶Œ ë“±) |
| stock           | INT                     | ì¬ê³  ìˆ˜ëŸ‰ (-1: ë¬´ì œí•œ)             |
| is_active       | BOOLEAN DEFAULT TRUE    | í™œì„± ì—¬ë¶€                          |
| created_at      | TIMESTAMP DEFAULT NOW() | ìƒì„±ì¼                             |

### ë¼ì´ë¸Œ ì±„íŒ… ë©”ì‹œì§€ í…Œì´ë¸” (chat_messages)

> **í™œìš© í™”ë©´**: H019 (ë¼ì´ë¸Œ ìƒì„¸)

| ì»¬ëŸ¼ëª…            | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                    |
| ----------------- | ----------------------- | ----------------------- |
| id (PK)           | UUID                    | ë©”ì‹œì§€ ê³ ìœ  ì‹ë³„ì      |
| streaming_id (FK) | UUID                    | ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ ID      |
| user_id (FK)      | UUID                    | ë°œì‹ ì ID               |
| message           | VARCHAR(500)            | ì±„íŒ… ë©”ì‹œì§€ ë‚´ìš©        |
| is_deleted        | BOOLEAN DEFAULT FALSE   | ì‚­ì œ ì—¬ë¶€ (ê´€ë¦¬ì ì‚­ì œ) |
| created_at        | TIMESTAMP DEFAULT NOW() | ì „ì†¡ ì¼ì‹œ               |

### ë¼ì´ë¸Œ í•˜íŠ¸ ê¸°ë¡ í…Œì´ë¸” (live_hearts)

> **í™œìš© í™”ë©´**: H019 (ë¼ì´ë¸Œ ìƒì„¸)

| ì»¬ëŸ¼ëª…            | ë°ì´í„° íƒ€ì…             | ì„¤ëª…                  |
| ----------------- | ----------------------- | --------------------- |
| id (PK)           | UUID                    | í•˜íŠ¸ ê¸°ë¡ ê³ ìœ  ì‹ë³„ì |
| streaming_id (FK) | UUID                    | ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ ID    |
| user_id (FK)      | UUID                    | ì‚¬ìš©ì ID             |
| count             | INT DEFAULT 1           | í•˜íŠ¸ ê°œìˆ˜             |
| created_at        | TIMESTAMP DEFAULT NOW() | ì „ì†¡ ì¼ì‹œ             |

> **TODO**: `payment_history` (ê²°ì œ ë‚´ì—­) í…Œì´ë¸”ì€ PGì‚¬ ì„ ì • í›„ ì¶”ê°€ ì˜ˆì •

---

## 3. í…Œì´ë¸” ê°„ ê´€ê³„ë„ (ERD)

```mermaid
erDiagram
    users ||--o{ auth_tokens : has
    users ||--o{ votes : makes
    users ||--o{ notifications : receives
    users ||--o{ media : uploads
    users ||--o{ points : has
    users ||--o{ memberships : has
    users ||--o{ likes : makes
    users ||--o{ user_favorites : follows
    users ||--o{ saved_posts : saves
    users ||--o{ ticket_reservations : reserves
    users ||--o{ support_tickets : submits
    users ||--o{ search_history : searches
    users ||--o{ chat_messages : sends
    users ||--o{ live_hearts : sends

    artists ||--o{ user_favorites : followed_by
    artists ||--o{ streaming_events : performs

    polls ||--o{ vote_options : has
    vote_options ||--o{ votes : receives
    polls ||--o{ votes : contains

    points ||--o{ point_transactions : has

    crawled_concerts ||--o{ ticket_reservations : booked_for

    streaming_events ||--o{ chat_messages : contains
    streaming_events ||--o{ live_hearts : receives

    likes }o--|| users : made_by
```

---

## 4. MongoDB ì»¬ë ‰ì…˜ ì„¤ê³„ (ì»¤ë®¤ë‹ˆí‹°)

### íŒ¬ ì»¤ë®¤ë‹ˆí‹° ì»¬ë ‰ì…˜ (posts)

#### 4.1 ì»¬ë ‰ì…˜ ê°œìš”

-   ì»¬ë ‰ì…˜ëª…: `posts`
-   ì„¤ëª…: íŒ¬ ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€ì„ ì €ì¥í•˜ëŠ” ì»¬ë ‰ì…˜
-   ë¹„ê³ : ëŒ“ê¸€ì€ `comments` ì»¬ë ‰ì…˜ì—ì„œ ë¶„ë¦¬ ê´€ë¦¬ (ê³ ëŒ“ê¸€Â·ëŒ€ëŒ“ê¸€ í™•ì¥, í˜ì´ì§• ê³ ë ¤)

#### 4.2 í•„ë“œ ì •ì˜

| í•„ë“œëª…          | íƒ€ì…         | ì„¤ëª…                                 | ë¹„ê³                       |
| --------------- | ------------ | ------------------------------------ | ------------------------- |
| `_id`           | ObjectId     | MongoDB ê¸°ë³¸ PK                      |                           |
| `post_id`       | UUID(String) | ê²Œì‹œê¸€ ê³ ìœ  ì‹ë³„ì (ì„œë¹„ìŠ¤ ê³µí†µ ID)  | RDB/ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ì—°ë™ìš©  |
| `user_id`       | UUID(String) | ì‘ì„±ì ID                            | `users.id` ì°¸ì¡°           |
| `artist_id`     | UUID(String) | ì•„í‹°ìŠ¤íŠ¸ ID                          | ì•„í‹°ìŠ¤íŠ¸ë³„ ì»¤ë®¤ë‹ˆí‹°ìš©     |
| `content`       | String       | ê²Œì‹œê¸€ ë‚´ìš©                          |                           |
| `images`        | [String]     | ì´ë¯¸ì§€ URL ë¦¬ìŠ¤íŠ¸                    | ê¸°ì¡´ `image_url`ì„ ë°°ì—´ë¡œ |
| `like_count`    | NumberInt    | ì¢‹ì•„ìš” ìˆ˜                            | ì§‘ê³„ìš© í•„ë“œ (optional)    |
| `comment_count` | NumberInt    | ëŒ“ê¸€ ìˆ˜                              | ëª©ë¡ í™”ë©´ ìµœì í™”ìš©        |
| `tags`          | [String]     | íƒœê·¸ ë¦¬ìŠ¤íŠ¸                          | ê²€ìƒ‰/í•„í„°ìš© (optional)    |
| `status`        | String       | ê²Œì‹œê¸€ ìƒíƒœ (`active`, `deleted` ë“±) | ì†Œí”„íŠ¸ ì‚­ì œìš© (optional)  |
| `created_at`    | Date         | ì‘ì„± ì¼ì‹œ                            |                           |
| `updated_at`    | Date         | ìˆ˜ì • ì¼ì‹œ                            | optional                  |

#### 4.3 ì˜ˆì‹œ ë„íë¨¼íŠ¸

```json
{
  "_id": ObjectId("67a1b0f2c9e4a5d123456789"),
  "post_id": "3f1b9e3a-8d7a-4e3c-9c2b-92a6b7c0fd10",
  "user_id": "0f2a8b51-47c0-4b0c-9c2b-1a2b3c4d5e6f",
  "artist_id": "9a7b6c5d-4e3f-2a1b-0c9d-8e7f6a5b4c3d",
  "content": "ì˜¤ëŠ˜ ì»´ë°± ì‡¼ì¼€ì´ìŠ¤ ë‹¤ë…€ì˜¨ í›„ê¸° ì˜¬ë ¤ìš”! ğŸ”¥",
  "images": [
    "https://cdn.fanpulse.app/posts/3f1b9e3a/photo1.jpg",
    "https://cdn.fanpulse.app/posts/3f1b9e3a/photo2.jpg"
  ],
  "like_count": 124,
  "comment_count": 37,
  "tags": ["ì»´ë°±", "ì‡¼ì¼€ì´ìŠ¤", "ì„œìš¸ì½˜"],
  "status": "active",
  "created_at": ISODate("2025-02-25T10:15:00Z"),
  "updated_at": ISODate("2025-02-25T11:02:30Z")
}
```

#### 4.4 ì¸ë±ìŠ¤ ì„¤ê³„

**ê¸°ë³¸ ì¸ë±ìŠ¤**

-   `{ post_id: 1 }` â€“ ì„œë¹„ìŠ¤ ë ˆë²¨ì—ì„œ UUIDë¡œ ì¡°íšŒí•  ë•Œ
-   `{ user_id: 1, created_at: -1 }` â€“ íŠ¹ì • ìœ ì € ê²Œì‹œê¸€ ëª©ë¡
-   `{ artist_id: 1, created_at: -1 }` â€“ ì•„í‹°ìŠ¤íŠ¸ë³„ ìµœì‹  ê²Œì‹œê¸€ ëª©ë¡

**ì¶”ê°€ ì¸ë±ìŠ¤(ì„ íƒ)**

-   `{ tags: 1 }` â€“ íƒœê·¸ ê²€ìƒ‰ìš©
-   `{ like_count: -1 }` â€“ ì¸ê¸°ê¸€ ì •ë ¬ìš©

### ëŒ“ê¸€ ì»¬ë ‰ì…˜ (comments)

#### 5.1 ì»¬ë ‰ì…˜ ê°œìš”

-   ì»¬ë ‰ì…˜ëª…: `comments`
-   ì„¤ëª…: ê²Œì‹œê¸€ì— ë‹¬ë¦° ëŒ“ê¸€ì„ ì €ì¥í•˜ëŠ” ì»¬ë ‰ì…˜
-   ë¹„ê³ : `post_id`ë¡œ `posts` ì»¬ë ‰ì…˜ê³¼ ì—°ê²° (ì¤‘ì²© ë„íë¨¼íŠ¸ ëŒ€ì‹  ë¶„ë¦¬ ì„¤ê³„)

#### 5.2 í•„ë“œ ì •ì˜

| í•„ë“œëª…       | íƒ€ì…         | ì„¤ëª…                               | ë¹„ê³                         |
| ------------ | ------------ | ---------------------------------- | --------------------------- |
| `_id`        | ObjectId     | MongoDB ê¸°ë³¸ PK                    |                             |
| `comment_id` | UUID(String) | ëŒ“ê¸€ ê³ ìœ  ì‹ë³„ì (ì„œë¹„ìŠ¤ ê³µí†µ ID)  | ì„ íƒì´ì§€ë§Œ í†µì¼ì„± ìœ„í•´ ì¶”ì²œ |
| `post_id`    | UUID(String) | ê´€ë ¨ëœ ê²Œì‹œê¸€ ID (`posts.post_id`) | FK ì—­í•                      |
| `user_id`    | UUID(String) | ì‘ì„±ì ID                          | `users.id` ì°¸ì¡°             |
| `parent_id`  | UUID(String) | ë¶€ëª¨ ëŒ“ê¸€ ID (ëŒ€ëŒ“ê¸€ì¼ ê²½ìš°)       | ê¸°ë³¸ null, ëŒ€ëŒ“ê¸€ ê¸°ëŠ¥ ëŒ€ë¹„ |
| `content`    | String       | ëŒ“ê¸€ ë‚´ìš©                          |                             |
| `status`     | String       | ëŒ“ê¸€ ìƒíƒœ (`active`, `deleted` ë“±) | ì†Œí”„íŠ¸ ì‚­ì œìš©(optional)     |
| `created_at` | Date         | ì‘ì„± ì¼ì‹œ                          |                             |
| `updated_at` | Date         | ìˆ˜ì • ì¼ì‹œ                          | optional                    |

#### 5.3 ì˜ˆì‹œ ë„íë¨¼íŠ¸

```json
{
  "_id": ObjectId("67a1b2c3d4e5f67890123456"),
  "comment_id": "e2f3c4b5-a6d7-8e9f-0a1b-2c3d4e5f6a7b",
  "post_id": "3f1b9e3a-8d7a-4e3c-9c2b-92a6b7c0fd10",
  "user_id": "7b6c5d4e-3f2a-1b0c-9d8e-7f6a5b4c3d2e",
  "parent_id": null,
  "content": "í›„ê¸° ê°ì‚¬í•©ë‹ˆë‹¤!! í˜„ì¥ ë¶„ìœ„ê¸° ì–´ë• ì–´ìš”? ğŸ˜†",
  "status": "active",
  "created_at": ISODate("2025-02-25T10:20:00Z"),
  "updated_at": ISODate("2025-02-25T10:20:00Z")
}
```

#### 5.4 ì¸ë±ìŠ¤ ì„¤ê³„

**ê¸°ë³¸ ì¸ë±ìŠ¤**

-   `{ post_id: 1, created_at: 1 }` â€“ ê²Œì‹œê¸€ë³„ ëŒ“ê¸€ í˜ì´ì§• ì¡°íšŒ
-   `{ user_id: 1, created_at: -1 }` â€“ íŠ¹ì • ìœ ì €ì˜ ëŒ“ê¸€ ë‚´ì—­

**ì¶”ê°€ ì¸ë±ìŠ¤(ì„ íƒ)**

-   `{ parent_id: 1, created_at: 1 }` â€“ ëŒ€ëŒ“ê¸€ íŠ¸ë¦¬ êµ¬ì¡° ì¡°íšŒ ì‹œ
